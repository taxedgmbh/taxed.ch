import{j as e,ak as $,al as M,ag as f,m as A,am as F,z as J,u as O,v as X,h as U,E as Y}from"./vendor-ui-834bd4ab.js";import{f as K,e as V,r as l,L as Q}from"./vendor-react-fa5d0322.js";import{H as ee}from"./vendor-helmet-7425e547.js";import{a as te,u as se,B as g,g as ae,b as ie}from"./main-34225568.js";import"./vendor-firebase-cb809cd2.js";const le="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjRjJGMkYyIi8+CiAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iI0NDQyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlByb2R1Y3QgSW1hZ2U8L3RleHQ+Cjwvc3ZnPgo=";function me(){var P,z,Z;const{id:y}=K(),B=V(),[t,D]=l.useState(null),[H,j]=l.useState(!0),[v,N]=l.useState(null),[s,w]=l.useState(null),[o,L]=l.useState(1),[C,c]=l.useState(0),{addToCart:I}=te(),{toast:h}=se(),R=l.useCallback(async()=>{if(t&&s){const i=s.inventory_quantity;try{await I(t,s,o,i),h({title:"Added to Cart! ðŸ›’",description:`${o} x ${t.title} (${s.title}) added.`})}catch(a){h({variant:"destructive",title:"Oh no! Something went wrong.",description:a.message})}}},[t,s,o,I,h]),k=l.useCallback(i=>{L(a=>{const n=a+i;return n<1?1:n})},[]),q=l.useCallback(()=>{var i;((i=t==null?void 0:t.images)==null?void 0:i.length)>1&&c(a=>a===0?t.images.length-1:a-1)},[(P=t==null?void 0:t.images)==null?void 0:P.length]),E=l.useCallback(()=>{var i;((i=t==null?void 0:t.images)==null?void 0:i.length)>1&&c(a=>a===t.images.length-1?0:a+1)},[(z=t==null?void 0:t.images)==null?void 0:z.length]),G=l.useCallback(i=>{var a;if(w(i),i.image_url&&((a=t==null?void 0:t.images)==null?void 0:a.length)>0){const n=t.images.findIndex(m=>m.url===i.image_url);n!==-1&&c(n)}},[t==null?void 0:t.images]);if(l.useEffect(()=>{(async()=>{try{j(!0),N(null);const a=await ae(y);try{const n=await ie({fields:"inventory_quantity",product_ids:[a.id]}),m=new Map;n.variants.forEach(r=>{m.set(r.id,r.inventory_quantity)});const x={...a,variants:a.variants.map(r=>({...r,inventory_quantity:m.get(r.id)??r.inventory_quantity}))};D(x),x.variants&&x.variants.length>0&&w(x.variants[0])}catch(n){throw n}}catch(a){N(a.message||"Failed to load product")}finally{j(!1)}})()},[y,B]),H)return e.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:e.jsx($,{className:"h-16 w-16 text-steel-blue animate-spin"})});if(v||!t)return e.jsxs("div",{className:"max-w-5xl mx-auto py-10 px-4",children:[e.jsxs(Q,{to:"/store",className:"inline-flex items-center gap-2 text-dark-gray hover:text-steel-blue transition-colors mb-6",children:[e.jsx(M,{size:16}),"Back to Store"]}),e.jsxs("div",{className:"text-center text-brand-red p-8 bg-white rounded-2xl shadow-lg",children:[e.jsx(f,{className:"mx-auto h-16 w-16 mb-4"}),e.jsxs("p",{className:"mb-6",children:["Error loading product: ",v]})]})]});const T=(s==null?void 0:s.sale_price_in_cents_formatted)??(s==null?void 0:s.price_in_cents_formatted),W=s==null?void 0:s.price_in_cents_formatted,_=s?s.inventory_quantity:0,u=(s==null?void 0:s.manage_inventory)??!1,b=!u||o<=_,p=t.images.length>0?t.images:[{url:t.image}],d=p[C],S=p.length>1;return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{children:[e.jsxs("title",{children:[t.title," | Taxed GmbH"]}),e.jsx("meta",{name:"description",content:((Z=t.description)==null?void 0:Z.substring(0,160))||t.title})]}),e.jsxs("div",{className:"max-w-6xl mx-auto py-10 px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(Q,{to:"/store",className:"inline-flex items-center gap-2 text-dark-gray hover:text-steel-blue transition-colors",children:[e.jsx(M,{size:16}),"Back to Store"]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12 bg-white p-8 rounded-2xl shadow-lg",children:[e.jsxs(A.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"relative",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg shadow-xl h-96 md:h-[500px]",children:[e.jsx("img",{src:d!=null&&d.url?d.url:le,alt:t.title,className:"w-full h-full object-cover"}),S&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:q,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10","aria-label":"Previous image",children:e.jsx(F,{size:20})}),e.jsx("button",{onClick:E,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10","aria-label":"Next image",children:e.jsx(J,{size:20})})]}),t.ribbon_text&&e.jsx("div",{className:"absolute top-4 left-4 bg-brand-red text-white text-sm font-bold px-4 py-2 rounded-full shadow-lg z-10",children:t.ribbon_text})]}),S&&e.jsx("div",{className:"flex justify-center gap-2 mt-4",children:p.map((i,a)=>e.jsx("button",{onClick:()=>c(a),className:`w-3 h-3 rounded-full transition-colors ${a===C?"bg-steel-blue":"bg-gray-300 hover:bg-gray-400"}`,"aria-label":`Go to image ${a+1}`},a))})]}),e.jsxs(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"flex flex-col",children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-dark-gray mb-2",children:t.title}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:t.subtitle}),e.jsxs("div",{className:"flex items-baseline gap-3 mb-6",children:[e.jsx("span",{className:"text-4xl font-bold text-brand-red",children:T}),(s==null?void 0:s.sale_price_in_cents)&&e.jsx("span",{className:"text-2xl text-gray-400 line-through",children:W})]}),e.jsx("div",{className:"prose text-gray-700 mb-6",dangerouslySetInnerHTML:{__html:t.description}}),t.variants.length>1&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-dark-gray mb-2",children:"Options"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.variants.map(i=>e.jsx(g,{variant:(s==null?void 0:s.id)===i.id?"default":"outline",onClick:()=>G(i),className:`transition-all ${(s==null?void 0:s.id)===i.id?"bg-steel-blue border-steel-blue text-white":"border-gray-300 text-dark-gray hover:bg-gray-100"}`,children:i.title},i.id))})]}),e.jsx("div",{className:"flex items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md p-1",children:[e.jsx(g,{onClick:()=>k(-1),variant:"ghost",size:"icon",className:"rounded-full h-8 w-8 text-gray-600 hover:bg-gray-100",children:e.jsx(O,{size:16})}),e.jsx("span",{className:"w-10 text-center text-dark-gray font-bold",children:o}),e.jsx(g,{onClick:()=>k(1),variant:"ghost",size:"icon",className:"rounded-full h-8 w-8 text-gray-600 hover:bg-gray-100",children:e.jsx(X,{size:16})})]})}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs(g,{onClick:R,size:"lg",className:"w-full bg-brand-red hover:bg-brand-red/90 text-white font-semibold py-3 text-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b||!t.purchasable,children:[e.jsx(U,{className:"mr-2 h-5 w-5"})," Add to Cart"]}),u&&b&&t.purchasable&&e.jsxs("p",{className:"text-sm text-green-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(Y,{size:16})," In stock"]}),u&&!b&&t.purchasable&&e.jsxs("p",{className:"text-sm text-yellow-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(f,{size:16})," Not enough stock. Only ",_," left."]}),!t.purchasable&&e.jsxs("p",{className:"text-sm text-red-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(f,{size:16})," Currently unavailable"]})]})]})]})]})]})}export{me as default};
