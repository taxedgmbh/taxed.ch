import{a3 as F,a4 as J,C as i,a5 as L,w as O,a6 as E,a7 as V,l as e,a8 as Y,m as B,a9 as M,aa as v,G as U,b as P,ab as X,Q as K,a as x,Z as ee,a0 as ae,O as te,_ as se}from"./main-3d4d0525.js";const le="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjRjJGMkYyIi8+CiAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iI0NDQyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlByb2R1Y3QgSW1hZ2U8L3RleHQ+Cjwvc3ZnPgo=";function ne(){var p,j,y;const{id:f}=F(),A=J(),[a,G]=i.useState(null),[H,N]=i.useState(!0),[w,k]=i.useState(null),[s,_]=i.useState(null),[o,R]=i.useState(1),[C,c]=i.useState(0),{addToCart:I}=L(),{toast:m}=O(),D=i.useCallback(async()=>{if(a&&s){const t=s.inventory_quantity;try{await I(a,s,o,t),m({title:"Added to Cart! ðŸ›’",description:`${o} x ${a.title} (${s.title}) added.`})}catch(l){m({variant:"destructive",title:"Oh no! Something went wrong.",description:l.message})}}},[a,s,o,I,m]),z=i.useCallback(t=>{R(l=>{const n=l+t;return n<1?1:n})},[]),$=i.useCallback(()=>{var t;((t=a==null?void 0:a.images)==null?void 0:t.length)>1&&c(l=>l===0?a.images.length-1:l-1)},[(p=a==null?void 0:a.images)==null?void 0:p.length]),q=i.useCallback(()=>{var t;((t=a==null?void 0:a.images)==null?void 0:t.length)>1&&c(l=>l===a.images.length-1?0:l+1)},[(j=a==null?void 0:a.images)==null?void 0:j.length]),Q=i.useCallback(t=>{var l;if(_(t),t.image_url&&((l=a==null?void 0:a.images)==null?void 0:l.length)>0){const n=a.images.findIndex(r=>r.url===t.image_url);n!==-1&&c(n)}},[a==null?void 0:a.images]);if(i.useEffect(()=>{(async()=>{try{N(!0),k(null);const t=await E(f);try{const l=await V({fields:"inventory_quantity",product_ids:[t.id]}),n=new Map;l.variants.forEach(d=>{n.set(d.id,d.inventory_quantity)});const r={...t,variants:t.variants.map(d=>({...d,inventory_quantity:n.get(d.id)??d.inventory_quantity}))};G(r),r.variants&&r.variants.length>0&&_(r.variants[0])}catch(l){throw l}}catch(t){k(t.message||"Failed to load product")}finally{N(!1)}})()},[f,A]),H)return e.jsx("div",{className:"flex justify-center items-center h-[60vh]",children:e.jsx(Y,{className:"h-16 w-16 text-steel-blue animate-spin"})});if(w||!a)return e.jsxs("div",{className:"max-w-5xl mx-auto py-10 px-4",children:[e.jsxs(B,{to:"/store",className:"inline-flex items-center gap-2 text-dark-gray hover:text-steel-blue transition-colors mb-6",children:[e.jsx(M,{size:16}),"Back to Store"]}),e.jsxs("div",{className:"text-center text-brand-red p-8 bg-white rounded-2xl shadow-lg",children:[e.jsx(v,{className:"mx-auto h-16 w-16 mb-4"}),e.jsxs("p",{className:"mb-6",children:["Error loading product: ",w]})]})]});const W=(s==null?void 0:s.sale_price_in_cents_formatted)??(s==null?void 0:s.price_in_cents_formatted),T=s==null?void 0:s.price_in_cents_formatted,S=s?s.inventory_quantity:0,u=(s==null?void 0:s.manage_inventory)??!1,g=!u||o<=S,h=a.images.length>0?a.images:[{url:a.image}],b=h[C],Z=h.length>1;return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsxs("title",{children:[a.title," | Taxed GmbH"]}),e.jsx("meta",{name:"description",content:((y=a.description)==null?void 0:y.substring(0,160))||a.title})]}),e.jsxs("div",{className:"max-w-6xl mx-auto py-10 px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(B,{to:"/store",className:"inline-flex items-center gap-2 text-dark-gray hover:text-steel-blue transition-colors",children:[e.jsx(M,{size:16}),"Back to Store"]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12 bg-white p-8 rounded-2xl shadow-lg",children:[e.jsxs(P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"relative",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg shadow-xl h-96 md:h-[500px]",children:[e.jsx("img",{src:b!=null&&b.url?b.url:le,alt:a.title,className:"w-full h-full object-cover"}),Z&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10","aria-label":"Previous image",children:e.jsx(X,{size:20})}),e.jsx("button",{onClick:q,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors z-10","aria-label":"Next image",children:e.jsx(K,{size:20})})]}),a.ribbon_text&&e.jsx("div",{className:"absolute top-4 left-4 bg-brand-red text-white text-sm font-bold px-4 py-2 rounded-full shadow-lg z-10",children:a.ribbon_text})]}),Z&&e.jsx("div",{className:"flex justify-center gap-2 mt-4",children:h.map((t,l)=>e.jsx("button",{onClick:()=>c(l),className:`w-3 h-3 rounded-full transition-colors ${l===C?"bg-steel-blue":"bg-gray-300 hover:bg-gray-400"}`,"aria-label":`Go to image ${l+1}`},l))})]}),e.jsxs(P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"flex flex-col",children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-dark-gray mb-2",children:a.title}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:a.subtitle}),e.jsxs("div",{className:"flex items-baseline gap-3 mb-6",children:[e.jsx("span",{className:"text-4xl font-bold text-brand-red",children:W}),(s==null?void 0:s.sale_price_in_cents)&&e.jsx("span",{className:"text-2xl text-gray-400 line-through",children:T})]}),e.jsx("div",{className:"prose text-gray-700 mb-6",dangerouslySetInnerHTML:{__html:a.description}}),a.variants.length>1&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-dark-gray mb-2",children:"Options"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.variants.map(t=>e.jsx(x,{variant:(s==null?void 0:s.id)===t.id?"default":"outline",onClick:()=>Q(t),className:`transition-all ${(s==null?void 0:s.id)===t.id?"bg-steel-blue border-steel-blue text-white":"border-gray-300 text-dark-gray hover:bg-gray-100"}`,children:t.title},t.id))})]}),e.jsx("div",{className:"flex items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md p-1",children:[e.jsx(x,{onClick:()=>z(-1),variant:"ghost",size:"icon",className:"rounded-full h-8 w-8 text-gray-600 hover:bg-gray-100",children:e.jsx(ee,{size:16})}),e.jsx("span",{className:"w-10 text-center text-dark-gray font-bold",children:o}),e.jsx(x,{onClick:()=>z(1),variant:"ghost",size:"icon",className:"rounded-full h-8 w-8 text-gray-600 hover:bg-gray-100",children:e.jsx(ae,{size:16})})]})}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs(x,{onClick:D,size:"lg",className:"w-full bg-brand-red hover:bg-brand-red/90 text-white font-semibold py-3 text-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!g||!a.purchasable,children:[e.jsx(te,{className:"mr-2 h-5 w-5"})," Add to Cart"]}),u&&g&&a.purchasable&&e.jsxs("p",{className:"text-sm text-green-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(se,{size:16})," In stock"]}),u&&!g&&a.purchasable&&e.jsxs("p",{className:"text-sm text-yellow-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(v,{size:16})," Not enough stock. Only ",S," left."]}),!a.purchasable&&e.jsxs("p",{className:"text-sm text-red-600 mt-3 flex items-center justify-center gap-2",children:[e.jsx(v,{size:16})," Currently unavailable"]})]})]})]})]})]})}export{ne as default};
