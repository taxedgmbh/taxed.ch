import{j as e,g as P,aF as E,bt as I,A as $,m as v,J as U,a1 as Q,bu as M,an as z,o as R,ae as H,V as C,a as G,L as J,bv as V,aC as W,al as K,U as O,v as D}from"./vendor-ui-834bd4ab.js";import{r as i,f as X,e as Y}from"./vendor-react-fa5d0322.js";import{F as b}from"./ForumLayout-8f3df3f4.js";import{C as m}from"./card-00599351.js";import{B as o}from"./main-7d439351.js";import{B as L}from"./badge-dcd888a2.js";import{I as Z}from"./input-6a3bda08.js";import{b as T,a as q}from"./forum-715b09c2.js";import"./vendor-helmet-7425e547.js";import"./vendor-firebase-cb809cd2.js";const ee=({topics:x=[],categoryId:u,onTopicClick:r,onLike:y,onBookmark:h,loading:j=!1,className:N=""})=>{const[d,S]=i.useState(""),[g,f]=i.useState("newest"),[n,_]=i.useState("all"),p=[...x.filter(s=>{const l=s.title.toLowerCase().includes(d.toLowerCase())||s.content.toLowerCase().includes(d.toLowerCase())||s.tags.some(t=>t.toLowerCase().includes(d.toLowerCase())),c=n==="all"||n==="solved"&&s.isSolved||n==="unsolved"&&!s.isSolved||n==="featured"&&s.isFeatured;return l&&c})].sort((s,l)=>{switch(g){case"newest":return new Date(l.createdAt).getTime()-new Date(s.createdAt).getTime();case"popular":return l.views-s.views;case"replies":return l.replies-s.replies;default:return 0}}),A=s=>{switch(s){case"pinned":return e.jsx(V,{className:"w-4 h-4 text-yellow-500"});case"locked":return e.jsx(J,{className:"w-4 h-4 text-gray-500"});default:return null}},F=s=>{switch(s){case"expert":return"bg-purple-100 text-purple-800";case"moderator":return"bg-blue-100 text-blue-800";case"admin":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return j?e.jsx("div",{className:`space-y-4 ${N}`,children:[...Array(5)].map((s,l)=>e.jsx(m,{className:"p-6 animate-pulse",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"})]})]})},l))}):e.jsxs("div",{className:`space-y-6 ${N}`,children:[e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Z,{type:"text",placeholder:"Search topics...",value:d,onChange:s=>S(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:n,onChange:s=>_(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"All Topics"}),e.jsx("option",{value:"solved",children:"Solved"}),e.jsx("option",{value:"unsolved",children:"Unsolved"}),e.jsx("option",{value:"featured",children:"Featured"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:g,onChange:s=>f(s.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"popular",children:"Most Popular"}),e.jsx("option",{value:"replies",children:"Most Replies"})]})]})]})]})}),e.jsx("div",{className:"space-y-4",children:e.jsx($,{children:p.map((s,l)=>e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:l*.05},whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsx(m,{className:"p-6 hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:()=>r==null?void 0:r(s),children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-1 pt-1",children:[A(s.status),s.isSolved&&e.jsx(U,{className:"w-4 h-4 text-green-500"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:c=>{c.stopPropagation(),y==null||y(s.id)},className:"text-gray-500 hover:text-red-500",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),s.likes]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:c=>{c.stopPropagation(),h==null||h(s.id)},className:"text-gray-500 hover:text-blue-500",children:e.jsx(M,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:s.content}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"font-medium",children:s.author.name}),e.jsx(L,{className:`ml-2 ${F(s.author.role)}`,children:s.author.role})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),new Date(s.createdAt).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),s.views," views"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),s.replies," replies"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.tags.map(c=>e.jsxs(L,{variant:"outline",className:"text-xs",children:["#",c]},c))}),s.lastReply&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsxs("span",{children:["Last reply by ",s.lastReply.author]}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{children:s.lastReply.createdAt})]}),e.jsx(G,{className:"w-4 h-4 text-gray-400"})]})})]})]})})},s.id))})}),p.length===0&&e.jsxs(m,{className:"p-12 text-center",children:[e.jsx(C,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No topics found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d?"Try adjusting your search terms":"Be the first to start a discussion"}),e.jsx(o,{className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Create New Topic"})]})]})},me=()=>{const{categorySlug:x}=X(),u=Y(),[r,y]=i.useState(null),[h,j]=i.useState([]),[N,d]=i.useState([]),[S,g]=i.useState(!0),[f,n]=i.useState(null),[_,B]=i.useState(""),p=["Be specific about your tax situation","Include relevant documents when possible","Respect privacy and confidentiality","Follow Swiss tax law guidelines"],A=t=>({"individual-tax-returns":"ðŸ‘¤","business-tax-services":"ðŸ¢","international-tax":"ðŸŒ","tax-planning":"ðŸ“š","general-discussion":"ðŸ’¬"})[t]||"ðŸ“",F=t=>({id:t.id.toString(),title:t.title,slug:t.slug,content:t.content,author:{id:"1",name:`${t.author_name||"Anonymous"} ${t.author_lastname||""}`.trim(),role:t.author_karma>100?"expert":"member"},category:{id:t.category_slug,name:t.category_name,slug:t.category_slug,color:t.category_color||"#3B82F6"},tags:[],status:t.status,isSolved:t.is_solved,isFeatured:t.is_featured,views:t.views||0,replies:t.replies_count||0,likes:t.upvotes||0,lastReply:{author:"Community",createdAt:t.last_reply_at||t.created_at},createdAt:t.created_at,updatedAt:t.last_reply_at||t.created_at});i.useEffect(()=>{x&&(async()=>{g(!0),n(null);try{const[a,w]=await Promise.all([T(x),q({category:x})]);if(!a){n("Category not found"),g(!1);return}y({id:a.id.toString(),name:a.name,slug:a.slug,description:a.description,icon:a.slug,color:a.color||"#3B82F6",topicCount:a.topic_count||0,postCount:a.post_count||0,lastActivity:a.last_activity?new Date(a.last_activity).toLocaleDateString():"No activity yet",rules:p});const k=w.map(F);j(k),d(k)}catch(a){console.error("Error fetching forum data:",a),n(a.message||"Failed to load forum data")}finally{g(!1)}})()},[x]);const s=()=>{u("/forum")},l=t=>{u(`/forum/topic/${t.slug}`)},c=t=>{if(B(t),!t.trim()){j(N);return}const a=N.filter(w=>w.title.toLowerCase().includes(t.toLowerCase())||w.content.toLowerCase().includes(t.toLowerCase()));j(a)};return S?e.jsx(b,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-6"}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((t,a)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded"},a))})]})})}):f?e.jsx(b,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error Loading Category"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx(o,{onClick:()=>window.location.reload(),children:"Try Again"}),e.jsx(o,{variant:"outline",onClick:()=>u("/forum"),children:"Back to Forum"})]})]})}):r?e.jsx(b,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("div",{className:"flex items-center space-x-4 mb-6",children:e.jsxs(o,{variant:"ghost",onClick:()=>u("/forum"),className:"flex items-center",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Back to Forum"]})}),e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center text-white text-2xl font-medium flex-shrink-0",style:{backgroundColor:r.color},children:A(r.slug)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),e.jsxs(L,{className:"bg-blue-100 text-blue-800",children:[r.topicCount," topics"]})]}),e.jsx("p",{className:"text-gray-600 mb-4 text-lg",children:r.description}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),r.topicCount," topics"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),r.postCount," posts"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"Last activity: ",r.lastActivity]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(o,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"New Topic"]})})]})})]}),e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:e.jsxs(m,{className:"p-6 bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Community Guidelines"}),e.jsx("ul",{className:"space-y-2 text-sm text-blue-800",children:r.rules.map((t,a)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"â€¢"}),t]},a))})]})}),e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsx(ee,{topics:h,categoryId:r.id,onTopicClick:l,onSearch:c})}),h.length===0&&!_&&e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(m,{className:"p-12 text-center",children:[e.jsx(C,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No topics found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Be the first to start a discussion in this category."}),e.jsxs(o,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Create First Topic"]})]})})]})}):e.jsx(b,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Category Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The category you're looking for doesn't exist."}),e.jsx(o,{onClick:()=>u("/forum"),children:"Back to Forum"})]})})};export{me as default};
